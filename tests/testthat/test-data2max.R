test_that("data2max works", {
  mth<-c("ZH","ZJ","QJ","ZH","FU","ZH","QJ","FU","FU","ZH")
  zmth<-c(NA,NA,NA,NA,"CZ",NA,NA,"DS","CZ",NA)
  xbest<-c(NA,4,NA,NA,NA,NA,NA,NA,NA,NA)
  qup<-c(NA,NA,5,NA,NA,NA,5,NA,NA,NA)
  qlow<-c(NA,NA,3,NA,NA,NA,3,NA,NA,NA)
  Subject	<-c(	1	,	2	,	3	,	4	,	5	,	6	,	7	,	8	,	9	,	10	,	11	,	12	,	13	,	14	,	15	,	16	,	17	,	18	,	19	,	20	,	21	)
  SYZ	<-c(	0	,	1	,	1	,	1	,	0	,	0	,	1	,	1	,	1	,	0	,	0	,	1	,	1	,	1	,	0	,	0	,	1	,	1	,	1	,	0	,	1	)
  YFYL	<-c(	0.25	,	0.75	,	0.5	,	0.75	,	0.75	,	0.5	,	1	,	1	,	0.25	,	0.5	,	0.25	,	0.5	,	0.75	,	0	,	0	,	0.5	,	0.75	,	0.75	,	0.25	,	0	,	0.75	)
  RM	<-c(	0.3333333	,	1	,	0.6666667	,	0.6666667	,	0.6666667	,	1	,	1	,	1	,	0.3333333	,	1	,	0.3333333	,	0.6666667	,	1	,	0	,	0	,	0.6666667	,	1	,	1	,	0.3333333	,	0	,	1	)
  LHYY	<-c(	1	,	1	,	0	,	1	,	0	,	1	,	1	,	1	,	1	,	1	,	0	,	1	,	0	,	0	,	1	,	0	,	1	,	1	,	1	,	0	,	1	)
  LC	<-c(	4	,	1	,	3	,	0	,	0	,	2	,	1	,	1	,	3	,	2	,	3	,	3	,	1	,	4	,	4	,	3	,	2	,	2	,	3	,	4	,	1	)
  TSRQ	<-c(	1	,	1	,	0	,	1	,	1	,	1	,	1	,	1	,	0	,	1	,	0	,	1	,	1	,	1	,	1	,	1	,	1	,	1	,	1	,	0	,	1	)
  GYSD	<-c(	0.28877376	,	0.31787883	,	0.97996964	,	0.23501848	,	0.20650739	,	0.34777587	,	0.33163939	,	0.66278379	,	0.66654567	,	1	,	0.1281019	,	1	,	1	,	0.31193902	,	0.07375264	,	0	,	1	,	0.30679118	,	1	,	0.4156877	,	1	)
  BLFY	<-c(	1.00000000 	,	0.16666670 	,	0.20000000 	,	0.25000000 	,	0.50000000 	,	0.25000000 	,	0.20000000 	,	0.25000000 	,	0.25000000 	,	0.50000000 	,	1.00000000 	,	0.50000000 	,	0.50000000 	,	0.33333330 	,	0.25000000 	,	0.20000000 	,	0.50000000 	,	10000.00000000 	,	1.00000000 	,	0.20000000 	,	10000.00000000 	)
  XKQJ	<-c(	4	,	3	,	3	,	4	,	2	,	1	,	1	,	1	,	1	,	2	,	4	,	3	,	4	,	2	,	2	,	3	,	2	,	1	,	1	,	0	,	2	)
  YYJH	<-c(	1	,	4	,	2	,	0	,	5	,	1	,	4	,	4	,	1	,	2	,	0	,	2	,	3	,	1	,	5	,	5	,	3	,	4	,	2	,	4	,	2	)
  MAXresult<-data.frame(Subject	,	SYZ	,	YFYL	,	RM	,	LHYY	,	LC	,	TSRQ	,	GYSD	,	BLFY	,	XKQJ	,	YYJH)
  expect_identical(round(data2max(sampleData,mth,zmth,xbest,qlow,qup),4),round(MAXresult,4))
})
