test_that("WtTopsis works", {
  mth<-c("ZH","ZJ","QJ","ZH","FU","ZH","QJ","FU","FU","ZH")
  zmth<-c(NA,NA,NA,NA,"CZ",NA,NA,"DS","CZ",NA)
  xbest<-c(NA,4,NA,NA,NA,NA,NA,NA,NA,NA)
  qup<-c(NA,NA,5,NA,NA,NA,5,NA,NA,NA)
  qlow<-c(NA,NA,3,NA,NA,NA,3,NA,NA,NA)
  Subject<-c(1	,	2	,	3	,	4	,	5	,	6	,	7	,	8	,	9	,	10	,	11	,	12	,	13	,	14	,	15	,	16	,	17	,	18	,	19	,	20	,	21)
  Dmax<-c(0.51699641	,	0.50356785	,	0.51058545	,	0.51229239	,	0.52114437	,	0.51632567	,	0.50516334	,	0.50319865	,	0.51239616	,	0.51090133	,	0.52914839	,	0.50196085	,	0.50730132	,	0.52127639	,	0.52136413	,	0.51924226	,	0.50077493	,	0.08470323	,	0.50748697	,	0.53002608	,	0.08040791)
  Dmin<-c(0.13993548	,	0.17751808	,	0.15209403	,	0.16339655	,	0.12483197	,	0.13004338	,	0.17994807	,	0.18530518	,	0.14381261	,	0.15383045	,	0.0897358	,	0.17911966	,	0.17589922	,	0.13132618	,	0.14433122	,	0.1317231	,	0.18642458	,	0.52663733	,	0.16530727	,	0.09931306	,	0.52886849)
  Cvalue<-c(0.2130137	,	0.2606398	,	0.2295137	,	0.2418221	,	0.1932454	,	0.2011906	,	0.2626552	,	0.2691418	,	0.2191568	,	0.2314173	,	0.1449961	,	0.2629934	,	0.2574635	,	0.2012345	,	0.2168127	,	0.2023504	,	0.2712816	,	0.8614467	,	0.2457026	,	0.1578053	,	0.8680272)
  Cresult<-data.frame(Subject,Dmax,Dmin,Cvalue)
  expect_identical(round(WtTopsis(sampleData,mth,zmth,xbest,qlow,qup),4),round(Cresult,4))
})
